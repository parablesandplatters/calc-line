<!doctype html>

<html lang="en">
  
<head>
  
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  
  <title>calc-line</title>
  
  <meta name="description" content="A single-file, design-forward calculator (index.html)." />
  
  <style>
    /* Reset */
    *{box-sizing:border-box;margin:0;padding:0}
    :root{
      --bg:#0f1724; --panel:#0b1220; --glass:rgba(255,255,255,0.04);
      --accent:#7c3aed; --accent-2:#06b6d4; --muted:rgba(255,255,255,0.65);
      --glass-2:rgba(255,255,255,0.03);
      --btn-shadow: 0 6px 20px rgba(2,6,23,0.6);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    html,body{height:100%}
    body{
      background: radial-gradient(1200px 600px at 10% 20%, rgba(124,58,237,0.12), transparent 6%),
                  radial-gradient(900px 500px at 90% 80%, rgba(6,182,212,0.08), transparent 6%),
                  var(--bg);
      display:flex;align-items:center;justify-content:center;padding:32px;color:#fff;-webkit-font-smoothing:antialiased;
    }

    .shell{
      width:min(460px,95vw);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:22px;padding:18px;border:1px solid rgba(255,255,255,0.04);box-shadow: 0 10px 40px rgba(2,6,23,0.6);
      backdrop-filter: blur(8px);
    }

    header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
    .logo{
      width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));
      display:flex;align-items:center;justify-content:center;font-weight:700;font-size:18px;box-shadow:var(--btn-shadow);
    }
    .title{line-height:1}
    .title h1{font-size:16px;letter-spacing:-0.2px}
    .title p{font-size:12px;color:var(--muted);margin-top:2px}

    .screen{
      height:108px;padding:16px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      margin-bottom:16px;display:flex;flex-direction:column;justify-content:space-between;box-shadow: inset 0 -6px 18px rgba(0,0,0,0.35);
    }
    .display-top{display:flex;justify-content:space-between;align-items:center;color:var(--muted);font-size:13px}
    .display-main{font-size:28px;font-weight:600;letter-spacing:0.2px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
    .display-small{font-size:13px;color:rgba(255,255,255,0.5)}

    .pad{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
    button.key{
      height:64px;border-radius:12px;border:0;background:linear-gradient(180deg,var(--glass),var(--glass-2));color:#fff;font-size:18px;font-weight:600;box-shadow:var(--btn-shadow);
      transition:transform .12s ease, box-shadow .12s ease;cursor:pointer;
    }
    button.key:active{transform:translateY(2px);box-shadow:0 4px 14px rgba(0,0,0,0.5)}

    .key.op{background:linear-gradient(180deg, rgba(124,58,237,0.95), rgba(6,182,212,0.9));}
    .key.wide{grid-column:span 2}
    .key.light{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));color:var(--muted);font-weight:700}

    .controls{display:flex;gap:8px;align-items:center}
    .small-btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 10px;border-radius:10px;color:var(--muted);font-size:13px;cursor:pointer}

    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px;color:var(--muted);font-size:13px}
    .credit{opacity:0.9}

    /* Responsive */
    @media (max-width:420px){
      .display-main{font-size:22px}
      button.key{height:56px;font-size:16px}
      .logo{width:46px;height:46px}
    }

    /* subtle focus for accessibility */
    button.key:focus{outline:2px solid rgba(124,58,237,0.16)}

  </style>
</head>
<body>
  <main class="shell" role="application" aria-label="Stylish calculator">
    <header>
      <div class="logo">C</div>
      <div class="title">
        <h1>calc-line</h1>
      </div>
      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <button class="small-btn" id="copyBtn" title="Copy result">Copy</button>
        <button class="small-btn" id="clearBtn" title="Clear">Clear</button>
      </div>
    </header>

    <section class="screen" aria-live="polite">
      <div class="display-top"><span id="mode">Standard</span><span class="display-small" id="expression">&nbsp;</span></div>
      <div class="display-main" id="display">0</div>
    </section>

    <section class="pad" role="grid">
      <button class="key light" data-key="(" aria-label="open parenthesis">(</button>
      <button class="key light" data-key=")" aria-label="close parenthesis">)</button>
      <button class="key light" data-key="%" aria-label="percent">%</button>
      <button class="key op" data-key="/" aria-label="divide">÷</button>

      <button class="key" data-key="7">7</button>
      <button class="key" data-key="8">8</button>
      <button class="key" data-key="9">9</button>
      <button class="key op" data-key="*" aria-label="multiply">×</button>

      <button class="key" data-key="4">4</button>
      <button class="key" data-key="5">5</button>
      <button class="key" data-key="6">6</button>
      <button class="key op" data-key="-" aria-label="minus">−</button>

      <button class="key" data-key="1">1</button>
      <button class="key" data-key="2">2</button>
      <button class="key" data-key="3">3</button>
      <button class="key op" data-key="+" aria-label="plus">+</button>

      <button class="key wide" data-key="0">0</button>
      <button class="key" data-key=".">.</button>
      <button class="key op" id="equals" data-key="=" aria-label="equals">=</button>
    </section>

    <div class="footer">
      <div class="credit">totn</div>
      <div class="hint">tip: use keyboard (numbers, + - * / Enter)</div>
    </div>
  </main>

  <script>
    
    (function(){
      const displayEl = document.getElementById('display');
      const exprEl = document.getElementById('expression');
      const keys = Array.from(document.querySelectorAll('button.key'));
      const copyBtn = document.getElementById('copyBtn');
      const clearBtn = document.getElementById('clearBtn');

      let expression = '';
      let lastResult = null;

      function render(){
        displayEl.textContent = expression || '0';
        exprEl.textContent = expression.length>28 ? expression.slice(-28) : expression;
      }

      function safeEval(expr){
        // allow only digits, operators, parentheses, decimal point and percent
        if(!/^[0-9()+\-*/.%\s]+$/.test(expr)) return 'ERR';
        try{
          // convert percent: 50% -> (50/100)
          const withPerc = expr.replace(/(\d+(?:\.\d+)?)%/g, '(($1)/100)');
          // use Function instead of eval for slightly better isolation
          // still sandbox is not perfect — keep calculator local only.
          const fn = new Function('return (' + withPerc + ')');
          const val = fn();
          if(typeof val === 'number' && isFinite(val)){
            // format: trim unnecessary decimals
            return Number.isInteger(val) ? String(val) : String(parseFloat(val.toFixed(10))).replace(/\.0+$/,'');
          }
          return 'ERR';
        }catch(e){
          return 'ERR';
        }
      }

      function press(key){
        if(key === '='){
          const res = safeEval(expression);
          if(res === 'ERR'){
            displayEl.textContent = 'Error';
          } else {
            displayEl.textContent = res;
            lastResult = res;
            expression = String(res);
          }
          exprEl.textContent = '';
          return;
        }

        if(key === 'Clear'){
          expression = '';
          lastResult = null;
          render();
          return;
        }

        if(key === 'Copy'){
          if(lastResult != null) navigator.clipboard?.writeText(String(lastResult));
          return;
        }

        // normal input
        if(key === '0' || key === '1' || key === '2' || key === '3' || key === '4' || key === '5' || key === '6' || key === '7' || key === '8' || key === '9' || key === '.' || key === '+' || key === '-' || key === '*' || key === '/' || key === '(' || key === ')' || key === '%'){
          // prevent leading zeros like 000...
          if(expression === '0' && /[0-9]/.test(key)) expression = key;
          else expression += key;
          render();
        }
      }

      keys.forEach(k => k.addEventListener('click', e => {
        const key = k.getAttribute('data-key');
        if(key === '=') press('='); else press(key);
      }));

      copyBtn.addEventListener('click', ()=>{
        if(lastResult != null) navigator.clipboard.writeText(String(lastResult)).then(()=>{
          copyBtn.textContent = 'Copied'; setTimeout(()=>copyBtn.textContent='Copy',900);
        }).catch(()=>{ copyBtn.textContent='No Clipboard'; setTimeout(()=>copyBtn.textContent='Copy',900); });
      });

      clearBtn.addEventListener('click', ()=>{ expression=''; lastResult=null; render(); });

      // keyboard support
      window.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter') { e.preventDefault(); press('='); return; }
        if(e.key === 'Backspace') { expression = expression.slice(0,-1); render(); return; }
        const allowed = '0123456789.+-*/()%';
        if(allowed.includes(e.key)) { press(e.key); }
      });

      // initial
      render();
    })();
  </script>
</body>
</html>



